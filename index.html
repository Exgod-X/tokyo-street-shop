<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CORPORATE SURVIVAL | Work Meme Apparel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&family=Bebas+Neue&display=swap" rel="stylesheet">
    
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://js.stripe.com/v3/"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background-color: #ffffff; 
            color: #111; 
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }
        
        .nike-display { 
            font-family: 'Bebas Neue', 'Impact', sans-serif; 
            letter-spacing: 0.02em;
        }
        
        /* Hero Image Parallax */
        .hero-parallax {
            transition: transform 0.1s ease-out;
        }
        
        /* Product Card Styling */
        .product-card { 
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: #ffffff;
        }
        .product-card:hover { 
            transform: translateY(-4px);
        }
        .product-card:hover .product-image {
            transform: scale(1.08);
        }
        .product-image {
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* Cart Sidebar */
        .cart-overlay {
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        .cart-overlay.open {
            opacity: 1;
            visibility: visible;
        }
        .cart-sidebar { 
            transform: translateX(100%); 
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1); 
        }
        .cart-sidebar.open { 
            transform: translateX(0); 
        }
        
        /* Buttons */
        .btn-primary {
            background: #111;
            color: #fff;
            transition: all 0.2s ease;
        }
        .btn-primary:hover {
            background: #444;
        }
        
        .btn-secondary {
            border: 1.5px solid #ccc;
            color: #111;
            transition: all 0.2s ease;
        }
        .btn-secondary:hover {
            border-color: #111;
        }
        
        /* Toast notifications */
        .toast { 
            transform: translateX(120%); 
            transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55); 
        }
        .toast.show { 
            transform: translateX(0); 
        }
        
        /* Size selector */
        .size-btn {
            transition: all 0.2s ease;
            border: 1.5px solid #e5e5e5;
        }
        .size-btn:hover:not(.selected):not(:disabled) {
            border-color: #111;
        }
        .size-btn.selected {
            border-color: #111;
            background: #111;
            color: #fff;
        }
        .size-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        /* Quantity controls */
        .qty-btn {
            transition: all 0.2s ease;
        }
        .qty-btn:hover:not(:disabled) {
            background: #f5f5f5;
        }
        .qty-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }
        
        /* Cart badge animation */
        @keyframes cartBounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.3); }
        }
        .cart-badge.animate {
            animation: cartBounce 0.3s ease;
        }
        
        /* Modal */
        .modal-overlay {
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        .modal-overlay.open {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            transform: scale(0.95) translateY(20px);
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        .modal-overlay.open .modal-content {
            transform: scale(1) translateY(0);
        }
        
        /* Auth Modal */
        .auth-modal {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
            transition: all 0.3s ease;
        }
        .auth-modal.open {
            opacity: 1;
            visibility: visible;
            pointer-events: all;
        }
        
        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f5f5f5;
        }
        ::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #999;
        }
        
        /* Hero text animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-fade-in-up {
            animation: fadeInUp 0.8s ease-out forwards;
        }
        
        .animate-delay-1 {
            animation-delay: 0.2s;
            opacity: 0;
        }
        
        .animate-delay-2 {
            animation-delay: 0.4s;
            opacity: 0;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Toast Container -->
    <div id="toast-container" class="fixed top-20 right-4 z-[60] flex flex-col gap-2 w-80 pointer-events-none"></div>

    <!-- Navigation -->
    <nav class="fixed top-0 w-full z-50 bg-white border-b border-gray-200">
        <div class="max-w-[1920px] mx-auto px-6 py-4">
            <div class="flex justify-between items-center">
                <!-- Logo -->
                <div class="flex items-center gap-12">
                    <a href="#" class="text-2xl font-black nike-display tracking-tight">CORPORATE SURVIVAL</a>
                    
                    <!-- Main Nav -->
                    <div class="hidden md:flex items-center gap-8 text-sm font-medium">
                        <a href="#new" class="text-gray-900 hover:text-gray-600 transition-colors">New Drops</a>
                        <a href="#hoodies" class="text-gray-900 hover:text-gray-600 transition-colors">Hoodies</a>
                        <a href="#tshirts" class="text-gray-900 hover:text-gray-600 transition-colors">T-Shirts</a>
                        <a href="#products" class="text-gray-900 hover:text-gray-600 transition-colors">Shop All</a>
                    </div>
                </div>
                
                <!-- Right Side -->
                <div class="flex items-center gap-6">
                    <!-- Search Bar -->
                    <div class="hidden lg:block">
                        <div class="relative">
                            <input type="text" placeholder="Search" 
                                   class="w-48 px-10 py-2 rounded-full bg-gray-100 text-sm focus:outline-none focus:bg-gray-200 transition-colors">
                            <svg class="absolute left-3 top-2.5 w-5 h-5 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                            </svg>
                        </div>
                    </div>
                    
                    <!-- User Account -->
                    <button onclick="toggleAuthModal()" id="auth-trigger" class="hidden md:block text-gray-900 hover:text-gray-600 transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                        </svg>
                    </button>
                    
                    <span id="user-display" class="hidden text-sm font-medium"></span>
                    
                    <!-- Cart Button -->
                    <button onclick="toggleCart()" class="relative hover:opacity-60 transition-opacity">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
                        </svg>
                        <span id="cart-badge" class="cart-badge absolute -top-1 -right-1 bg-black text-white text-xs w-5 h-5 rounded-full flex items-center justify-center font-bold hidden">0</span>
                    </button>
                    
                    <!-- Mobile menu button -->
                    <button onclick="toggleMobileMenu()" class="md:hidden">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
            
            <!-- Mobile Menu -->
            <div id="mobile-menu" class="hidden md:hidden border-t border-gray-200 mt-4 pt-4">
                <div class="space-y-4">
                    <a href="#new" class="block text-gray-900 font-medium">New Drops</a>
                    <a href="#hoodies" class="block text-gray-900">Hoodies</a>
                    <a href="#tshirts" class="block text-gray-900">T-Shirts</a>
                    <a href="#products" class="block text-gray-900">Shop All</a>
                    <button onclick="toggleAuthModal()" class="block w-full text-left text-gray-900">Sign In</button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="pt-16 relative overflow-hidden bg-gray-50">
        <div class="relative h-[90vh] max-h-[800px] overflow-hidden">
            <div class="absolute inset-0 hero-parallax">
                <img src="https://images.unsplash.com/photo-1497032628192-86f99bcd76bc?w=1920&h=1080&fit=crop" 
                     alt="Office workspace" 
                     class="w-full h-full object-cover"
                     id="hero-image">
            </div>
            <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/30 to-transparent"></div>
            
            <!-- Hero Content -->
            <div class="relative h-full flex items-end pb-20">
                <div class="max-w-7xl mx-auto px-6 w-full">
                    <div class="max-w-2xl text-white">
                        <p class="text-sm font-semibold mb-2 animate-fade-in-up tracking-wide">FOR THE MODERN WORKER</p>
                        <h1 class="text-6xl md:text-7xl font-black nike-display mb-6 leading-none animate-fade-in-up animate-delay-1">
                            SURVIVE<br/>IN STYLE
                        </h1>
                        <p class="text-lg mb-8 text-gray-200 max-w-md animate-fade-in-up animate-delay-2">
                            Premium apparel for those who laugh through the daily grind. Because if you don't laugh, you'll cry at your desk.
                        </p>
                        <a href="#products" class="inline-block btn-primary px-8 py-4 rounded-full font-semibold animate-fade-in-up animate-delay-2 hover:scale-105 transition-transform">
                            Shop The Collection
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Categories -->
    <section class="py-12 bg-white">
        <div class="max-w-7xl mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="relative h-[500px] group cursor-pointer overflow-hidden">
                    <img src="https://images.unsplash.com/photo-1556821840-3a63f95609a7?w=800&h=1000&fit=crop" 
                         alt="Hoodies" 
                         class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
                    <div class="absolute inset-0 bg-black/20 group-hover:bg-black/30 transition-colors"></div>
                    <div class="absolute bottom-12 left-12">
                        <h3 class="text-white text-4xl font-bold nike-display mb-4">HOODIES</h3>
                        <p class="text-white/90 mb-4 text-sm">For when the AC is too cold<br/>and your motivation is frozen</p>
                        <button onclick="filterProducts('hoodie')" class="bg-white text-black px-6 py-3 rounded-full font-semibold hover:bg-gray-200 transition-colors">
                            Shop Hoodies
                        </button>
                    </div>
                </div>
                
                <div class="relative h-[500px] group cursor-pointer overflow-hidden">
                    <img src="https://images.unsplash.com/photo-1583743814966-8936f5b7be1a?w=800&h=1000&fit=crop" 
                         alt="T-Shirts" 
                         class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
                    <div class="absolute inset-0 bg-black/20 group-hover:bg-black/30 transition-colors"></div>
                    <div class="absolute bottom-12 left-12">
                        <h3 class="text-white text-4xl font-bold nike-display mb-4">T-SHIRTS</h3>
                        <p class="text-white/90 mb-4 text-sm">Casual Friday approved<br/>(probably)</p>
                        <button onclick="filterProducts('tshirt')" class="bg-white text-black px-6 py-3 rounded-full font-semibold hover:bg-gray-200 transition-colors">
                            Shop T-Shirts
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Products Section -->
    <section id="products" class="py-16 bg-white">
        <div class="max-w-[1920px] mx-auto px-6">
            <div class="flex items-center justify-between mb-8">
                <div>
                    <h2 class="text-2xl font-bold mb-1">Survival Gear</h2>
                    <p class="text-gray-600 text-sm">Officially unofficial corporate uniform</p>
                </div>
                <div class="flex gap-3">
                    <button onclick="filterProducts('all')" class="filter-btn px-4 py-2 text-sm rounded-full btn-secondary font-medium" data-filter="all">All</button>
                    <button onclick="filterProducts('hoodie')" class="filter-btn px-4 py-2 text-sm rounded-full btn-secondary font-medium" data-filter="hoodie">Hoodies</button>
                    <button onclick="filterProducts('tshirt')" class="filter-btn px-4 py-2 text-sm rounded-full btn-secondary font-medium" data-filter="tshirt">T-Shirts</button>
                </div>
            </div>
            
            <div id="products-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
                <!-- Products will be rendered here -->
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="py-20 bg-gray-50">
        <div class="max-w-6xl mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-12 text-center">
                <div>
                    <div class="text-5xl mb-4">ðŸ“§</div>
                    <h3 class="font-bold text-xl mb-3">Free Shipping</h3>
                    <p class="text-gray-600">Unlike your manager's expectations, our shipping is actually free over $50</p>
                </div>
                <div>
                    <div class="text-5xl mb-4">â˜•</div>
                    <h3 class="font-bold text-xl mb-3">Quality Materials</h3>
                    <p class="text-gray-600">More durable than your last New Year's resolution to quit</p>
                </div>
                <div>
                    <div class="text-5xl mb-4">ðŸ’¼</div>
                    <h3 class="font-bold text-xl mb-3">Perfect Fit</h3>
                    <p class="text-gray-600">Unlike that deadline, this actually fits comfortably</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonials Section -->
    <section class="py-20 bg-white">
        <div class="max-w-4xl mx-auto px-6 text-center">
            <h2 class="text-3xl font-bold mb-12">What Corporate Survivors Say</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="p-6 bg-gray-50 rounded-xl">
                    <p class="text-gray-700 mb-4">"Finally, a shirt that understands my pain. Wore it to the office, got called to HR. Worth it."</p>
                    <p class="font-semibold">- Sarah, Marketing</p>
                </div>
                <div class="p-6 bg-gray-50 rounded-xl">
                    <p class="text-gray-700 mb-4">"My manager asked where I got it. Now the whole team has matching hoodies. Team building: achieved."</p>
                    <p class="font-semibold">- Mike, Sales</p>
                </div>
                <div class="p-6 bg-gray-50 rounded-xl">
                    <p class="text-gray-700 mb-4">"Wearing this on Zoom calls is my new passive-aggressive power move."</p>
                    <p class="font-semibold">- Alex, IT</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="py-16 bg-black text-white">
        <div class="max-w-7xl mx-auto px-6">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-12 mb-12">
                <div>
                    <h3 class="font-bold text-lg mb-4 nike-display">CORPORATE SURVIVAL</h3>
                    <p class="text-gray-400 text-sm">Turning work frustrations into wearable art since 2025.</p>
                </div>
                <div>
                    <h4 class="font-semibold mb-4">Shop</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="#" class="hover:text-white transition-colors">New Arrivals</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Hoodies</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">T-Shirts</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Bestsellers</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold mb-4">Help</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="#" class="hover:text-white transition-colors">Order Status</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Shipping & Returns</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Size Guide</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Contact Us</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-semibold mb-4">About</h4>
                    <ul class="space-y-2 text-sm text-gray-400">
                        <li><a href="#" class="hover:text-white transition-colors">Our Story</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Careers (lol jk)</a></li>
                        <li><a href="#" class="hover:text-white transition-colors">Press</a></li>
                    </ul>
                </div>
            </div>
            <div class="border-t border-gray-800 pt-8 flex flex-col md:flex-row justify-between items-center gap-4 text-sm text-gray-500">
                <p>Â© 2025 Corporate Survival. All rights reserved. No meetings were held to create this.</p>
                <div class="flex gap-6">
                    <a href="#" class="hover:text-white transition-colors">Privacy Policy</a>
                    <a href="#" class="hover:text-white transition-colors">Terms of Use</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- ==================== AUTH MODAL ==================== -->
    <div id="auth-modal" class="auth-modal fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm">
        <div class="bg-white rounded-2xl max-w-md w-full mx-4 p-8 relative">
            <button onclick="toggleAuthModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            
            <div class="mb-8">
                <h2 id="form-title" class="text-3xl font-bold text-gray-900 mb-2">Sign In</h2>
                <p id="form-subtitle" class="text-gray-600">Enter your details to continue</p>
            </div>

            <!-- Login Form -->
            <form id="login-form" class="space-y-4" onsubmit="event.preventDefault(); handleLogin();">
                <div>
                    <label class="text-sm font-medium text-gray-700 block mb-2">Email</label>
                    <input type="email" id="login-email" required
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-black focus:outline-none transition-colors">
                </div>

                <div>
                    <label class="text-sm font-medium text-gray-700 block mb-2">Password</label>
                    <input type="password" id="login-password" required
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-black focus:outline-none transition-colors">
                </div>

                <div id="login-error" class="hidden text-red-600 text-sm bg-red-50 py-2 px-3 rounded-lg"></div>

                <button type="submit" id="login-btn" 
                        class="w-full py-4 btn-primary rounded-full font-semibold text-lg transition-all hover:scale-[1.02]">
                    Sign In
                </button>

                <p class="text-center text-gray-600 text-sm mt-6">
                    Don't have an account? 
                    <button type="button" onclick="toggleAuthMode()" class="text-black font-semibold hover:underline">
                        Sign up
                    </button>
                </p>
            </form>

            <!-- Register Form -->
            <form id="register-form" class="hidden space-y-4" onsubmit="event.preventDefault(); handleRegister();">
                <div>
                    <label class="text-sm font-medium text-gray-700 block mb-2">Username</label>
                    <input type="text" id="reg-username" required
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-black focus:outline-none transition-colors">
                </div>

                <div>
                    <label class="text-sm font-medium text-gray-700 block mb-2">Email</label>
                    <input type="email" id="reg-email" required
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-black focus:outline-none transition-colors">
                </div>

                <div>
                    <label class="text-sm font-medium text-gray-700 block mb-2">Password (min 6 chars)</label>
                    <input type="password" id="reg-password" required minlength="6"
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-black focus:outline-none transition-colors">
                </div>

                <div>
                    <label class="text-sm font-medium text-gray-700 block mb-2">Confirm Password</label>
                    <input type="password" id="reg-confirm" required
                           class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-black focus:outline-none transition-colors">
                </div>

                <div id="register-error" class="hidden text-red-600 text-sm bg-red-50 py-2 px-3 rounded-lg"></div>
                
                <div id="register-success" class="hidden text-green-600 text-sm bg-green-50 py-3 px-3 rounded-lg">
                    <div class="font-bold mb-1">âœ“ Account Created!</div>
                    <div>Check your email to confirm your account.</div>
                </div>

                <button type="submit" id="register-btn" 
                        class="w-full py-4 btn-primary rounded-full font-semibold text-lg transition-all hover:scale-[1.02]">
                    Create Account
                </button>

                <div class="flex items-start gap-2 text-xs text-gray-600">
                    <input type="checkbox" id="terms-checkbox" required class="mt-0.5">
                    <span>I agree to the <a href="#" class="underline hover:text-black">Terms</a> and <a href="#" class="underline hover:text-black">Privacy Policy</a></span>
                </div>

                <p class="text-center text-gray-600 text-sm mt-6">
                    Already have an account? 
                    <button type="button" onclick="toggleAuthMode()" class="text-black font-semibold hover:underline">
                        Sign in
                    </button>
                </p>
            </form>
        </div>
    </div>

    <!-- ==================== CART SIDEBAR ==================== -->
    <div id="cart-overlay" class="cart-overlay fixed inset-0 bg-black/40 z-[70]" onclick="toggleCart()"></div>
    
    <div id="cart-sidebar" class="cart-sidebar fixed top-0 right-0 h-full w-full max-w-md bg-white z-[80] flex flex-col shadow-2xl">
        <!-- Cart Header -->
        <div class="flex items-center justify-between p-6 border-b border-gray-200">
            <h2 class="text-xl font-bold">Bag</h2>
            <button onclick="toggleCart()" class="p-2 hover:bg-gray-100 rounded-full transition-colors">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
        
        <!-- Cart Items -->
        <div id="cart-items" class="flex-1 overflow-y-auto p-6 space-y-4">
            <!-- Cart items will be rendered here -->
        </div>
        
        <!-- Cart Empty State -->
        <div id="cart-empty" class="flex-1 flex flex-col items-center justify-center p-8 text-center">
            <svg class="w-16 h-16 text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"></path>
            </svg>
            <p class="text-gray-600 mb-2 font-medium">Your bag is empty</p>
            <p class="text-gray-500 text-sm mb-4">Unlike your email inbox on Monday morning</p>
            <button onclick="toggleCart()" class="text-black font-semibold hover:underline">Continue Shopping</button>
        </div>
        
        <!-- Cart Footer -->
        <div id="cart-footer" class="hidden border-t border-gray-200 p-6 space-y-4">
            <div class="flex justify-between items-center">
                <span class="font-medium">Subtotal</span>
                <span id="cart-subtotal" class="font-bold text-lg">$0.00</span>
            </div>
            <div class="text-xs text-gray-600">
                <p>Shipping and taxes calculated at checkout</p>
            </div>
            <button onclick="proceedToCheckout()" id="checkout-btn" class="w-full py-4 btn-primary rounded-full font-semibold text-lg transition-all hover:scale-[1.02]">
                Checkout
            </button>
        </div>
    </div>

    <!-- ==================== PRODUCT QUICK VIEW MODAL ==================== -->
    <div id="product-modal" class="modal-overlay fixed inset-0 bg-black/40 z-[90] flex items-center justify-center p-4">
        <div class="modal-content bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div id="modal-content-inner">
                <!-- Modal content will be rendered here -->
            </div>
        </div>
    </div>

    <!-- ==================== JAVASCRIPT ==================== -->
    <script>
        // ==========================================
        // CONFIGURATION
        // ==========================================
        
        const SUPABASE_URL = 'https://ukewtbhpcsxahkocmhfm.supabase.co';
        const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVrZXd0YmhwY3N4YWhrb2NtaGZtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk4NzUzMjksImV4cCI6MjA4NTQ1MTMyOX0.Ujnkq7pX-eA6ZLXcf2WwOd4LWrWuD4bcmb0sRJxL2QA';
        const STRIPE_PUBLISHABLE_KEY = 'pk_test_51SxS9vEvXdzvVm9XvsJ9ucARLlhvs9MfZ6w1ePcNZnZvFNDQoAitDHV9v4Jlwyh3TXmaFMVQ3n5N8YA8GnnlLUWn00p8IMjS9n';
        
        let supabaseClient = null;
        let stripe = null;
        let isSupabaseConnected = false;
        let currentUser = null;
        
        // ==========================================
        // PRODUCT DATA - WORK MEME APPAREL
        // ==========================================
        
        const PRODUCTS = [
            {
                id: 'prod_001',
                name: 'Meeting Could\'ve Been An Email',
                price: 54.99,
                category: 'hoodie',
                image: 'https://images.unsplash.com/photo-1556821840-3a63f95609a7?w=400&h=500&fit=crop',
                description: 'Premium heavyweight hoodie for surviving unnecessary conference calls. Features "Send Help" pocket lining. 100% organic cotton, unlike your team\'s decision-making process.',
                sizes: ['S', 'M', 'L', 'XL', 'XXL'],
                stock: { S: 5, M: 10, L: 8, XL: 3, XXL: 2 }
            },
            {
                id: 'prod_002',
                name: 'Professional Overthinker',
                price: 34.99,
                category: 'tshirt',
                image: 'https://images.unsplash.com/photo-1583743814966-8936f5b7be1a?w=400&h=500&fit=crop',
                description: 'Soft cotton tee that says what you\'re thinking. Perfect for when your internal monologue needs external validation. Tagless for maximum comfort during your 3am work anxiety.',
                sizes: ['S', 'M', 'L', 'XL'],
                stock: { S: 12, M: 15, L: 10, XL: 8 }
            },
            {
                id: 'prod_003',
                name: 'Ctrl+Alt+Delete Monday',
                price: 59.99,
                category: 'hoodie',
                image: 'https://images.unsplash.com/photo-1620799140408-edc6dcb6d633?w=400&h=500&fit=crop',
                description: 'Oversized comfort hoodie for when you need to reboot your entire week. Comes with hidden pocket for emergency snacks and existential dread. One size fits all levels of burnout.',
                sizes: ['M', 'L', 'XL', 'XXL'],
                stock: { M: 6, L: 4, XL: 7, XXL: 5 }
            },
            {
                id: 'prod_004',
                name: 'Deadline Survivor',
                price: 37.99,
                category: 'tshirt',
                image: 'https://images.unsplash.com/photo-1521572163474-6864f9cf17ab?w=400&h=500&fit=crop',
                description: 'Battle-tested tee for warriors who\'ve seen things. Things like unrealistic timelines and scope creep. Breathable fabric for when your manager announces a "quick pivot."',
                sizes: ['S', 'M', 'L', 'XL', 'XXL'],
                stock: { S: 8, M: 12, L: 15, XL: 10, XXL: 6 }
            },
            {
                id: 'prod_005',
                name: 'Coffee Powered',
                price: 52.99,
                category: 'hoodie',
                image: 'https://images.unsplash.com/photo-1578587018452-892bacefd3f2?w=400&h=500&fit=crop',
                description: 'Zippered hoodie for the caffeine-dependent professional. Features motivational lining: "You got this (maybe)." Machine washable, unlike your performance review feedback.',
                sizes: ['S', 'M', 'L', 'XL'],
                stock: { S: 4, M: 9, L: 11, XL: 7 }
            },
            {
                id: 'prod_006',
                name: 'Send Help (and Coffee)',
                price: 36.99,
                category: 'tshirt',
                image: 'https://images.unsplash.com/photo-1618354691373-d851c5c3a990?w=400&h=500&fit=crop',
                description: 'Emergency signal tee for critical situations. Like when you\'re asked to "circle back" for the 47th time. Relaxed fit for maximum comfort during breakdowns.',
                sizes: ['S', 'M', 'L', 'XL'],
                stock: { S: 3, M: 7, L: 5, XL: 4 }
            },
            {
                id: 'prod_007',
                name: 'Target Achieved* (*Barely)',
                price: 57.99,
                category: 'hoodie',
                image: 'https://images.unsplash.com/photo-1614495039153-e9cd13240469?w=400&h=500&fit=crop',
                description: 'Celebratory hoodie with asterisk accuracy. Premium fleece for celebrating those technically-met KPIs. Comes with complimentary imposter syndrome.',
                sizes: ['S', 'M', 'L', 'XL', 'XXL'],
                stock: { S: 6, M: 8, L: 10, XL: 5, XXL: 3 }
            },
            {
                id: 'prod_008',
                name: 'Spreadsheet Wizard',
                price: 35.99,
                category: 'tshirt',
                image: 'https://images.unsplash.com/photo-1562157873-818bc0726f68?w=400&h=500&fit=crop',
                description: 'For Excel heroes and VLOOKUP legends. Moisture-wicking for when your pivot table crashes right before the presentation. Comes with secret pride.',
                sizes: ['S', 'M', 'L', 'XL'],
                stock: { S: 10, M: 14, L: 12, XL: 9 }
            }
        ];
        
        // ==========================================
        // CART STATE
        // ==========================================
        
        let cart = [];
        
        function loadCart() {
            const savedCart = localStorage.getItem('corporate_survival_cart');
            if (savedCart) {
                cart = JSON.parse(savedCart);
            }
            updateCartUI();
        }
        
        function saveCart() {
            localStorage.setItem('corporate_survival_cart', JSON.stringify(cart));
            updateCartUI();
        }
        
        // ==========================================
        // INITIALIZATION
        // ==========================================
        
        window.addEventListener('load', async function() {
            initializeStripe();
            loadCart();
            renderProducts();
            initializeAuth();
            initHeroParallax();
            checkUrlParams();
        });
        
        function checkUrlParams() {
            const params = new URLSearchParams(window.location.search);
            
            if (params.get('success') === 'true') {
                showToast('Order placed successfully! May your next deadline be reasonable.', 'success');
                clearCart();
                window.history.replaceState({}, document.title, window.location.pathname);
            } else if (params.get('canceled') === 'true') {
                showToast('Payment canceled. Your cart is still here, unlike that promotion.', 'info');
                window.history.replaceState({}, document.title, window.location.pathname);
            }
        }
        
        async function initializeAuth() {
            const savedUser = localStorage.getItem('corporate_survival_user');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                updateUserDisplay();
            }
            
            try {
                if (typeof supabase !== 'undefined') {
                    supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);
                    const { data } = await supabaseClient.auth.getSession();
                    if (data?.session?.user) {
                        currentUser = data.session.user;
                        localStorage.setItem('corporate_survival_user', JSON.stringify(currentUser));
                        updateUserDisplay();
                    }
                    isSupabaseConnected = true;
                }
            } catch (err) {
                console.log('Auth optional, continuing without');
            }
        }
        
        function initializeStripe() {
            try {
                if (STRIPE_PUBLISHABLE_KEY && STRIPE_PUBLISHABLE_KEY.startsWith('pk_')) {
                    stripe = Stripe(STRIPE_PUBLISHABLE_KEY);
                }
            } catch (err) {
                console.error('Stripe init failed:', err);
            }
        }
        
        function updateUserDisplay() {
            if (currentUser) {
                const username = currentUser.user_metadata?.username || currentUser.email?.split('@')[0] || 'User';
                document.getElementById('user-display').textContent = `Hi, ${username}`;
                document.getElementById('user-display').classList.remove('hidden');
                document.getElementById('auth-trigger').innerHTML = `
                    <button onclick="handleLogout()" class="text-sm font-medium hover:underline">Logout</button>
                `;
            }
        }
        
        // ==========================================
        // HERO PARALLAX
        // ==========================================
        
        function initHeroParallax() {
            const heroImage = document.getElementById('hero-image');
            if (!heroImage) return;
            
            window.addEventListener('scroll', () => {
                const scrolled = window.pageYOffset;
                const parallax = scrolled * 0.5;
                heroImage.style.transform = `translateY(${parallax}px) scale(1.1)`;
            });
        }
        
        // ==========================================
        // PRODUCT RENDERING
        // ==========================================
        
        function renderProducts(filter = 'all') {
            const grid = document.getElementById('products-grid');
            const filteredProducts = filter === 'all' 
                ? PRODUCTS 
                : PRODUCTS.filter(p => p.category === filter);
            
            grid.innerHTML = filteredProducts.map(product => `
                <div class="product-card cursor-pointer group" onclick="openQuickView('${product.id}')">
                    <div class="relative overflow-hidden aspect-square bg-gray-100 mb-3">
                        <img src="${product.image}" alt="${product.name}" 
                             class="product-image w-full h-full object-cover" 
                             loading="lazy">
                    </div>
                    <div class="px-1">
                        <div class="text-xs text-gray-600 mb-1">${product.category.toUpperCase()}</div>
                        <h3 class="font-semibold text-sm mb-1 group-hover:underline leading-tight">${product.name}</h3>
                        <p class="font-bold text-sm">$${product.price.toFixed(2)}</p>
                    </div>
                </div>
            `).join('');
            
            document.querySelectorAll('.filter-btn').forEach(btn => {
                if (btn.dataset.filter === filter) {
                    btn.classList.remove('btn-secondary');
                    btn.classList.add('btn-primary');
                } else {
                    btn.classList.remove('btn-primary');
                    btn.classList.add('btn-secondary');
                }
            });
        }
        
        function filterProducts(filter) {
            renderProducts(filter);
            document.getElementById('products').scrollIntoView({ behavior: 'smooth' });
        }
        
        // ==========================================
        // QUICK VIEW MODAL
        // ==========================================
        
        function openQuickView(productId) {
            const product = PRODUCTS.find(p => p.id === productId);
            if (!product) return;
            
            const modal = document.getElementById('product-modal');
            const content = document.getElementById('modal-content-inner');
            
            content.innerHTML = `
                <div class="relative">
                    <button onclick="closeQuickView()" class="absolute top-4 right-4 z-10 p-2 hover:bg-gray-100 rounded-full transition-colors">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                    <div class="grid md:grid-cols-2 gap-8 p-6">
                        <div class="aspect-square bg-gray-100 rounded-xl overflow-hidden">
                            <img src="${product.image}" alt="${product.name}" class="w-full h-full object-cover">
                        </div>
                        <div class="flex flex-col py-4">
                            <div class="text-xs text-gray-600 mb-2">${product.category.toUpperCase()}</div>
                            <h2 class="text-3xl font-bold mb-2">${product.name}</h2>
                            <p class="text-2xl font-bold mb-6">$${product.price.toFixed(2)}</p>
                            <p class="text-gray-600 mb-8">${product.description}</p>
                            
                            <div class="mb-8">
                                <label class="text-sm font-semibold mb-3 block">Select Size</label>
                                <div class="grid grid-cols-5 gap-2" id="size-selector">
                                    ${product.sizes.map(size => `
                                        <button onclick="selectSize('${size}')" 
                                                class="size-btn px-4 py-3 rounded-lg text-sm font-semibold ${product.stock[size] === 0 ? 'opacity-30 cursor-not-allowed' : ''}"
                                                data-size="${size}"
                                                ${product.stock[size] === 0 ? 'disabled' : ''}>
                                            ${size}
                                        </button>
                                    `).join('')}
                                </div>
                                <p id="size-error" class="hidden text-red-600 text-xs mt-2">Please select a size</p>
                            </div>
                            
                            <div class="mt-auto space-y-3">
                                <button onclick="addToCartFromModal('${product.id}')" 
                                        class="w-full py-4 btn-primary rounded-full font-semibold transition-all hover:scale-[1.02]">
                                    Add to Bag
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            modal.classList.add('open');
            document.body.style.overflow = 'hidden';
        }
        
        function closeQuickView() {
            document.getElementById('product-modal').classList.remove('open');
            document.body.style.overflow = '';
        }
        
        let selectedSize = null;
        
        function selectSize(size) {
            selectedSize = size;
            document.querySelectorAll('.size-btn').forEach(btn => {
                btn.classList.toggle('selected', btn.dataset.size === size);
            });
            document.getElementById('size-error').classList.add('hidden');
        }
        
        function addToCartFromModal(productId) {
            if (!selectedSize) {
                document.getElementById('size-error').classList.remove('hidden');
                return;
            }
            
            addToCart(productId, selectedSize);
            selectedSize = null;
            closeQuickView();
        }
        
        // ==========================================
        // CART FUNCTIONS
        // ==========================================
        
        function addToCart(productId, size, quantity = 1) {
            const product = PRODUCTS.find(p => p.id === productId);
            if (!product) return;
            
            const existingIndex = cart.findIndex(item => 
                item.productId === productId && item.size === size
            );
            
            if (existingIndex > -1) {
                if (cart[existingIndex].quantity + quantity > product.stock[size]) {
                    showToast('Stock limit reached (just like your patience)', 'error');
                    return;
                }
                cart[existingIndex].quantity += quantity;
            } else {
                cart.push({ productId, size, quantity, price: product.price });
            }
            
            saveCart();
            showToast(`Added to bag`, 'success');
            animateCartBadge();
        }
        
        function removeFromCart(index) {
            cart.splice(index, 1);
            saveCart();
        }
        
        function updateCartQuantity(index, newQuantity) {
            if (newQuantity < 1) {
                removeFromCart(index);
                return;
            }
            
            const item = cart[index];
            const product = PRODUCTS.find(p => p.id === item.productId);
            
            if (newQuantity > product.stock[item.size]) {
                showToast('Not enough stock', 'error');
                return;
            }
            
            cart[index].quantity = newQuantity;
            saveCart();
        }
        
        function clearCart() {
            cart = [];
            saveCart();
        }
        
        function getCartTotal() {
            return cart.reduce((total, item) => total + (item.price * item.quantity), 0);
        }
        
        function getCartCount() {
            return cart.reduce((count, item) => count + item.quantity, 0);
        }
        
        // ==========================================
        // CART UI
        // ==========================================
        
        function toggleCart() {
            const sidebar = document.getElementById('cart-sidebar');
            const overlay = document.getElementById('cart-overlay');
            
            sidebar.classList.toggle('open');
            overlay.classList.toggle('open');
            document.body.style.overflow = sidebar.classList.contains('open') ? 'hidden' : '';
        }
        
        function updateCartUI() {
            const badge = document.getElementById('cart-badge');
            const itemsContainer = document.getElementById('cart-items');
            const emptyState = document.getElementById('cart-empty');
            const footer = document.getElementById('cart-footer');
            const subtotal = document.getElementById('cart-subtotal');
            
            const count = getCartCount();
            const total = getCartTotal();
            
            if (count > 0) {
                badge.textContent = count > 99 ? '99+' : count;
                badge.classList.remove('hidden');
            } else {
                badge.classList.add('hidden');
            }
            
            if (cart.length === 0) {
                itemsContainer.classList.add('hidden');
                emptyState.classList.remove('hidden');
                footer.classList.add('hidden');
            } else {
                itemsContainer.classList.remove('hidden');
                emptyState.classList.add('hidden');
                footer.classList.remove('hidden');
                
                itemsContainer.innerHTML = cart.map((item, index) => {
                    const product = PRODUCTS.find(p => p.id === item.productId);
                    if (!product) return '';
                    
                    return `
                        <div class="flex gap-4 pb-4 border-b border-gray-200">
                            <div class="w-24 h-24 rounded-lg overflow-hidden bg-gray-100 flex-shrink-0">
                                <img src="${product.image}" alt="${product.name}" class="w-full h-full object-cover">
                            </div>
                            <div class="flex-1 min-w-0">
                                <h4 class="font-semibold text-sm mb-1 leading-tight">${product.name}</h4>
                                <p class="text-gray-600 text-xs mb-2">Size: ${item.size}</p>
                                <p class="font-bold text-sm">$${item.price.toFixed(2)}</p>
                                
                                <div class="flex items-center gap-3 mt-3">
                                    <button onclick="updateCartQuantity(${index}, ${item.quantity - 1})" 
                                            class="qty-btn w-8 h-8 flex items-center justify-center rounded-full border border-gray-300 text-sm hover:border-gray-900"
                                            ${item.quantity <= 1 ? 'disabled' : ''}>
                                        âˆ’
                                    </button>
                                    <span class="w-8 text-center text-sm font-medium">${item.quantity}</span>
                                    <button onclick="updateCartQuantity(${index}, ${item.quantity + 1})" 
                                            class="qty-btn w-8 h-8 flex items-center justify-center rounded-full border border-gray-300 text-sm hover:border-gray-900">
                                        +
                                    </button>
                                </div>
                            </div>
                            <button onclick="removeFromCart(${index})" class="text-gray-400 hover:text-gray-600 transition-colors">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
                                </svg>
                            </button>
                        </div>
                    `;
                }).join('');
                
                subtotal.textContent = `$${total.toFixed(2)}`;
            }
        }
        
        function animateCartBadge() {
            const badge = document.getElementById('cart-badge');
            badge.classList.add('animate');
            setTimeout(() => badge.classList.remove('animate'), 300);
        }
        
        // ==========================================
        // CHECKOUT
        // ==========================================
        
        async function proceedToCheckout() {
            if (cart.length === 0) {
                showToast('Your cart is empty', 'error');
                return;
            }
            
            if (!currentUser) {
                toggleCart();
                toggleAuthModal();
                showToast('Please sign in to checkout', 'info');
                return;
            }
            
            const btn = document.getElementById('checkout-btn');
            btn.disabled = true;
            btn.innerHTML = '<span class="animate-pulse">Processing...</span>';
            
            try {
                if (!stripe) {
                    await new Promise(resolve => setTimeout(resolve, 1500));
                    showToast('Demo Mode: Order simulated successfully', 'info');
                    clearCart();
                    toggleCart();
                    return;
                }
                
                const response = await fetch('/api/create-checkout-session', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        items: cart.map(item => ({
                            productId: item.productId,
                            size: item.size,
                            quantity: item.quantity
                        })),
                        userId: currentUser?.id || 'guest'
                    })
                });
                
                const { sessionId } = await response.json();
                const { error } = await stripe.redirectToCheckout({ sessionId });
                
                if (error) throw error;
                
            } catch (err) {
                console.error('Checkout error:', err);
                showToast('Checkout failed. Please try again.', 'error');
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'Checkout';
            }
        }
        
        // ==========================================
        // AUTH FUNCTIONS
        // ==========================================
        
        function toggleAuthModal() {
            const modal = document.getElementById('auth-modal');
            modal.classList.toggle('open');
            document.body.style.overflow = modal.classList.contains('open') ? 'hidden' : '';
        }
        
        async function handleRegister() {
            const username = document.getElementById('reg-username').value.trim();
            const email = document.getElementById('reg-email').value.trim();
            const password = document.getElementById('reg-password').value;
            const confirmPassword = document.getElementById('reg-confirm').value;
            const btn = document.getElementById('register-btn');
            
            document.getElementById('register-error').classList.add('hidden');
            document.getElementById('register-success').classList.add('hidden');
            
            if (!username || !email || !password) {
                showError('Please fill in all fields', 'register-error');
                return;
            }
            if (password !== confirmPassword) {
                showError('Passwords do not match', 'register-error');
                return;
            }
            if (password.length < 6) {
                showError('Password must be at least 6 characters', 'register-error');
                return;
            }
            
            btn.disabled = true;
            btn.textContent = 'Creating account...';
            
            try {
                if (!isSupabaseConnected) {
                    const users = JSON.parse(localStorage.getItem('corporate_survival_users') || '[]');
                    if (users.find(u => u.email === email)) {
                        throw new Error('Email already registered');
                    }
                    
                    const newUser = {
                        id: 'local_' + Date.now(),
                        email: email,
                        user_metadata: { username: username }
                    };
                    
                    users.push({ ...newUser, password: password });
                    localStorage.setItem('corporate_survival_users', JSON.stringify(users));
                    localStorage.setItem('corporate_survival_user', JSON.stringify(newUser));
                    currentUser = newUser;
                    
                    document.getElementById('register-success').classList.remove('hidden');
                    setTimeout(() => {
                        toggleAuthModal();
                        updateUserDisplay();
                    }, 2000);
                    
                } else {
                    const { data, error } = await supabaseClient.auth.signUp({
                        email: email,
                        password: password,
                        options: { data: { username: username } }
                    });
                    
                    if (error) throw error;
                    
                    if (data.user) {
                        if (data.session) {
                            currentUser = data.user;
                            localStorage.setItem('corporate_survival_user', JSON.stringify(currentUser));
                            toggleAuthModal();
                            updateUserDisplay();
                            showToast('Welcome to the grind!', 'success');
                        } else {
                            document.getElementById('register-success').classList.remove('hidden');
                        }
                    }
                }
            } catch (err) {
                showError(err.message, 'register-error');
            } finally {
                btn.disabled = false;
                btn.textContent = 'Create Account';
            }
        }
        
        async function handleLogin() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const btn = document.getElementById('login-btn');
            
            document.getElementById('login-error').classList.add('hidden');
            
            if (!email || !password) {
                showError('Please enter email and password', 'login-error');
                return;
            }
            
            btn.disabled = true;
            btn.textContent = 'Signing in...';
            
            try {
                if (!isSupabaseConnected) {
                    const users = JSON.parse(localStorage.getItem('corporate_survival_users') || '[]');
                    const user = users.find(u => u.email === email && u.password === password);
                    
                    if (!user) throw new Error('Invalid email or password');
                    
                    const sessionUser = {
                        id: user.id,
                        email: user.email,
                        user_metadata: user.user_metadata
                    };
                    localStorage.setItem('corporate_survival_user', JSON.stringify(sessionUser));
                    currentUser = sessionUser;
                    toggleAuthModal();
                    updateUserDisplay();
                    showToast('Welcome back, survivor!', 'success');
                    
                } else {
                    const { data, error } = await supabaseClient.auth.signInWithPassword({
                        email: email,
                        password: password
                    });
                    
                    if (error) throw error;
                    if (data.user) {
                        currentUser = data.user;
                        localStorage.setItem('corporate_survival_user', JSON.stringify(currentUser));
                        toggleAuthModal();
                        updateUserDisplay();
                        showToast('Welcome back, survivor!', 'success');
                    }
                }
            } catch (err) {
                showError(err.message, 'login-error');
            } finally {
                btn.disabled = false;
                btn.textContent = 'Sign In';
            }
        }
        
        function handleLogout() {
            if (isSupabaseConnected && supabaseClient) {
                supabaseClient.auth.signOut();
            }
            localStorage.removeItem('corporate_survival_user');
            currentUser = null;
            location.reload();
        }
        
        function toggleAuthMode() {
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            const title = document.getElementById('form-title');
            const subtitle = document.getElementById('form-subtitle');
            
            loginForm.classList.toggle('hidden');
            registerForm.classList.toggle('hidden');
            document.getElementById('login-error').classList.add('hidden');
            document.getElementById('register-error').classList.add('hidden');
            document.getElementById('register-success').classList.add('hidden');
            
            if (loginForm.classList.contains('hidden')) {
                title.textContent = 'Create Account';
                subtitle.textContent = 'Join the survivors';
            } else {
                title.textContent = 'Sign In';
                subtitle.textContent = 'Enter your details to continue';
            }
        }
        
        // ==========================================
        // UI HELPERS
        // ==========================================
        
        function toggleMobileMenu() {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        }
        
        function showError(message, elementId) {
            const el = document.getElementById(elementId);
            el.textContent = message;
            el.classList.remove('hidden');
            setTimeout(() => el.classList.add('hidden'), 5000);
        }
        
        function showToast(message, type) {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            const colors = {
                success: 'bg-green-600',
                error: 'bg-red-600',
                info: 'bg-blue-600'
            };
            
            toast.className = `toast pointer-events-auto ${colors[type]} text-white p-4 rounded-lg shadow-lg flex items-center gap-3`;
            toast.innerHTML = `<span class="text-sm font-medium">${message}</span>`;
            container.appendChild(toast);
            setTimeout(() => toast.classList.add('show'), 100);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 400);
            }, 3000);
        }
        
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeQuickView();
                const authModal = document.getElementById('auth-modal');
                if (authModal.classList.contains('open')) {
                    toggleAuthModal();
                }
                const cartSidebar = document.getElementById('cart-sidebar');
                if (cartSidebar.classList.contains('open')) {
                    toggleCart();
                }
            }
        });
    </script>
</body>
</html>
